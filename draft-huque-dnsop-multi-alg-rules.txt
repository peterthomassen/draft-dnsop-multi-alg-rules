



Internet Engineering Task Force                                 S. Huque
Internet-Draft                                                Salesforce
Updates: 4035, 6840 (if approved)                           P. Thomassen
Intended status: Standards Track                              deSEC, SSE
Expires: 11 January 2024                                    10 July 2023


                   Multiple Algorithm Rules in DNSSEC
                  draft-huque-dnsop-multi-alg-rules-00

Abstract

   This document proposes to address some limitations in the DNS
   protocol that pose challenges for DNSSEC configurations that
   advertise multiple Secure Entry Points (SEP) with different signing
   algorithms via their DS record or trust anchor set.  Solutions to
   these limitations will allow for both multi-signer operation and for
   the transfer of signed DNS zones between providers, where the
   providers support disjoint DNSSEC algorithm sets.  In addition, the
   proposal enables pre-publication of a trust anchor in preparation for
   an algorithm rollover, such as of the root zone.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 11 January 2024.

Copyright Notice

   Copyright (c) 2023 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights



Huque & Thomassen        Expires 11 January 2024                [Page 1]

Internet-Draft     Multiple Algorithm Rules in DNSSEC          July 2023


   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction and Motivation . . . . . . . . . . . . . . . . .   2
   2.  Current Multiple Algorithm Rules  . . . . . . . . . . . . . .   3
     2.1.  Discussion  . . . . . . . . . . . . . . . . . . . . . . .   3
     2.2.  Incompatible Use Cases  . . . . . . . . . . . . . . . . .   4
   3.  Proposed Updates to RFCs  . . . . . . . . . . . . . . . . . .   4
   4.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   5
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .   5
   6.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   5
   7.  Normative References  . . . . . . . . . . . . . . . . . . . .   5
   8.  Informative References  . . . . . . . . . . . . . . . . . . .   6
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   6

1.  Introduction and Motivation

   RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH BEFORE PUBLISHING:
   The source for this draft is maintained in GitHub at:
   https://github.com/shuque/draft-dnsop-multi-alg-rules

   The Domain Name System Security Extensions (DNSSEC) [RFC4033]
   [RFC4034] [RFC4035] add data origin authentication and integrity
   protection to the Domain Name System (DNS), by having DNS zone owners
   (or their operators) crytographically sign their zone data.

   The Multi-Signer Extensions [RFC8901] describe how multiple providers
   using distinct DNSSEC keys can co-operatively serve the same DNS
   zone.  DNSSEC Automation [DNSSEC-AUTO] further describes how to fully
   automate Multi-Signer operations, as well as how to use a
   transitional state of a multi-signer configuration to non-
   disruptively transfer a signed zone from one provider to another.
   These methods do not work however if the providers involved employ
   different DNSSEC algorithms, due to restrictions imposed by the
   current protocol specifications.  This is not just a theoretical
   problem.  Real situations in the field have occurred where this has
   posed an obstacle to DNSSEC deployment and operations.

   The same restrictions limit flexiblity during algorithm rollovers for
   zones with trust anchors.  To ensure that a validation is available,
   the old key and associated signatures cannot be removed until
   virtually all validating resolvers have updated their trust anchor
   (TA).  In order to allow resolver operators to perform this update,
   the new trust anchor has to be published ahead of time.



Huque & Thomassen        Expires 11 January 2024                [Page 2]

Internet-Draft     Multiple Algorithm Rules in DNSSEC          July 2023


   Current specifications [RFC6840] imply that when a trust anchor for a
   new algorithm is published, the associated DNSKEY and RRSIGs already
   need to be in place.  When rolling the algorithm for the root zone,
   this could lead to a potentialy very long phase of double-signing the
   zone, on the order of a year.  To reduce potential risks from
   unintended side effects (such as from overly large packets) during
   such a rollover, it seems desirable to create a way publishing the
   new trust anchor without introducing the new algorithm into the zone
   yet.

2.  Current Multiple Algorithm Rules

   Section 2.2 (last paragraph) of [RFC4035] states the following:

   |  There MUST be an RRSIG for each RRset using at least one DNSKEY of
   |  each algorithm in the zone apex DNSKEY RRset.  The apex DNSKEY
   |  RRset itself MUST be signed by each algorithm appearing in the DS
   |  RRset located at the delegating parent (if any).

   Further, Section 5.11 of [RFC6840] clarifies:

   |  A signed zone MUST include a DNSKEY for each algorithm present in
   |  the zone's DS RRset and expected trust anchors for the zone.

2.1.  Discussion

   Although unstated in that document, the original rationale for this
   rule was algorithm downgrade protection.  An attacker cannot
   undetectably strip away signatures by a stronger algorithm from
   signed DNS responses.  Section 5.11 of DNSSEC Clarifications
   [RFC6840], referring to the above rule, thus states that:

   |  This requirement applies to servers, not validators.  Validators
   |  SHOULD accept any single valid path.  They SHOULD NOT insist that
   |  all algorithms signaled in the DS RRset work, and they MUST NOT
   |  insist that all algorithms signaled in the DNSKEY RRset work.

   In general, when a validating resolver supporting any of the
   algorithms listed in a given zone's DS record or TA set responds to a
   query without the CD flag set, it may not treat that zone as
   insecure, but must return either validated data (AD=1) or RCODE=2
   (SERVFAIL).  For this purpose, any valid path suffices; the validator
   may not apply a "logical AND" approach to all advertised algorithms.

   At first glance, the assertions that (1) the signer provide
   signatures for all advertised algorithms while (2) the resolver shall
   be content with just one seems somewhat contradictory.  However, the
   role of the RRSIG rules is to ensure that the resolver will find a



Huque & Thomassen        Expires 11 January 2024                [Page 3]

Internet-Draft     Multiple Algorithm Rules in DNSSEC          July 2023


   valid path (using a "logical OR" strategy), regardless of which
   particular algorithm(s) it supports, and thus be able to distinguish
   reliably between "all is in order" (validated data) and a downgrade
   attack (SERVFAIL).

   In other words, even though one signature will suffice for
   validation, the signer cannot, in the general case, know which
   particular signing algorithm(s) the validator will support -- and
   hence, providing a "large enough set" (read: all of them) solves that
   problem.

2.2.  Incompatible Use Cases

   The above rules are incompatible with certain use cases:

   *  They are impractical to satisfy if DNS providers deployed in a
      multi-signer configuration are using different signing algorithms.
      By extension, it also means that multi-signer techniques cannot be
      employed to non-disruptively transfer a signed zone from one DNS
      provider to another if the providers use differing algorithms.

   *  The rules further collide with the conflicting goal of pre-
      publishing the new trust anchor during a zone's algorithm
      rollover, while introducing the new algorithm into the zone only
      later in the process.

   *  Furthermore, for online signers attempting to deploy multiple
      algorithms, producing signatures for several algorithms also
      imposes a significant computational burden, unless a selective
      algorithm negotiation mechanism is also developed.

   As the above rules present a severe limitation for these use cases,
   this document proposes to relax them in a way so that the set of
   signatures provided is still "large enough" to ensure reliable DNSSEC
   operation, while facilitating glitch-free multi-signer operation and
   TA pre-publication.

3.  Proposed Updates to RFCs

   Initial proposal: relax the quoted rule in RFC 4035.  Change the MUST
   to a SHOULD, and state that there are valid configurations where this
   rule could be disregarded.

   Longer term: develop a scheme to allow a zone owner to securely
   signal their desire for algorithm downgrade protection.  One possible
   method to do this is a "DS hack": namely overloading the signed DS
   record set in the parent zone to convey this signal, a technique that
   has been met with some resistance by protocol purists in the past.



Huque & Thomassen        Expires 11 January 2024                [Page 4]

Internet-Draft     Multiple Algorithm Rules in DNSSEC          July 2023


   Another method would be to define a new resource record type for this
   purpose.  Special consideration would have to given to where such a
   signal would be placed for the root zone if needed (or whether the
   root zone should just have a hardcoded rule).  Details of such a
   proposal are deferred to a future document (or a revision of this
   one).  If and when such a proposal is developed, the text in RFC
   6840, Section 5.11 will need to be updated to enforce algorithm
   downgrade protection in the presence of the signal.

4.  IANA Considerations

   Initially none.  If a later scheme for algorithm downgrade signaling
   is developed, new protocol parameter numbers will be needed for DS or
   a new resource record type.

5.  Security Considerations

   TBD.

6.  Acknowledgements

   The proposal in this draft was originally presented in [ICANN-TALK]
   by S.  Huque at the ICANN73 DNSSEC and Security workshop.

7.  Normative References

   [RFC4033]  Arends, R., Austein, R., Larson, M., Massey, D., and S.
              Rose, "DNS Security Introduction and Requirements",
              RFC 4033, DOI 10.17487/RFC4033, March 2005,
              <https://www.rfc-editor.org/info/rfc4033>.

   [RFC4034]  Arends, R., Austein, R., Larson, M., Massey, D., and S.
              Rose, "Resource Records for the DNS Security Extensions",
              RFC 4034, DOI 10.17487/RFC4034, March 2005,
              <https://www.rfc-editor.org/info/rfc4034>.

   [RFC4035]  Arends, R., Austein, R., Larson, M., Massey, D., and S.
              Rose, "Protocol Modifications for the DNS Security
              Extensions", RFC 4035, DOI 10.17487/RFC4035, March 2005,
              <https://www.rfc-editor.org/info/rfc4035>.

   [RFC6840]  Weiler, S., Ed. and D. Blacka, Ed., "Clarifications and
              Implementation Notes for DNS Security (DNSSEC)", RFC 6840,
              DOI 10.17487/RFC6840, February 2013,
              <https://www.rfc-editor.org/info/rfc6840>.






Huque & Thomassen        Expires 11 January 2024                [Page 5]

Internet-Draft     Multiple Algorithm Rules in DNSSEC          July 2023


   [RFC8901]  Huque, S., Aras, P., Dickinson, J., Vcelak, J., and D.
              Blacka, "Multi-Signer DNSSEC Models", RFC 8901,
              DOI 10.17487/RFC8901, September 2020,
              <https://www.rfc-editor.org/info/rfc8901>.

8.  Informative References

   [DNSSEC-AUTO]
              Wisser, U. and S. Huque, "DNSSEC Automation",
              <https://www.ietf.org/archive/id/draft-ietf-dnsop-dnssec-
              automation-01.html>.

   [ICANN-TALK]
              Huque, S., "RFC Adjustments for Multi-Signer",
              <https://tinyurl.com/multisigner-rfc-adjustments>.

Authors' Addresses

   Shumon Huque
   Salesforce
   415 Mission Street, 3rd Floor
   San Francisco, CA 94105
   United States of America
   Email: shuque@gmail.com


   Peter Thomassen
   deSEC, SSE
   Berlin
   Germany
   Email: peter@desec.io




















Huque & Thomassen        Expires 11 January 2024                [Page 6]
